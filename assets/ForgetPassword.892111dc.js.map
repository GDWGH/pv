{"version":3,"file":"ForgetPassword.892111dc.js","sources":["../../packages/user/ForgetPassword.vue"],"sourcesContent":["<template>\n  <div\n    class=\"forget-password h-screen w-full md:min-h-xl flex justify-end bg-center bg-no-repeat bg-cover dark:filter dark:brightness-75\"\n  >\n    <!-- Mobile view -->\n    <div\n      v-if=\"screenSizes['<md']\"\n      class=\"flex-wrap content-between w-full h-full p-5 shadow text-white flex filter drop-shadow-md backdrop-filter backdrop-blur-sm\"\n    >\n      <div class=\"w-full text-center\">\n        <Logo :larger=\"20\" />\n        <div class=\"text-lg\">\n          {{ t('user.forget-password.title') }}\n        </div>\n      </div>\n      <div class=\"w-full space-y-2\">\n        <div>\n          <div class=\"flex w-full border-b border-white\">\n            <div class=\"i-uil:envelope align-middle text-2xl\" />\n            <input\n              v-model=\"email\"\n              class=\"outline-none w-full bg-transparent placeholder-white\"\n              :placeholder=\"t('user.forget-password.email.placeholder')\"\n              @keydown.enter=\"sendEmail\"\n            >\n          </div>\n          <div class=\"text-red-500 text-sm h-4\">\n            {{ emailStatus }}\n          </div>\n        </div>\n        <div class=\"space-y-1\">\n          <button\n            :disabled=\"sendStatus === 'loading'\"\n            class=\"w-full py-2 border border-transparent rounded-md text-white bg-blue-600 focus:outline-none focus:ring-2 focus:bg-blue-700 disabled:bg-blue-300 disabled:focus:bg-blue-300\"\n            @click=\"sendEmail\"\n          >\n            {{\n              sendStatus === 'loading'\n                ? t('user.forget-password.send-status.loading')\n                : t('user.forget-password.send-status.ready')\n            }}\n          </button>\n          <div v-if=\"sendStatus === 'error'\" class=\"text-red-500\">\n            {{ errmsg }}\n          </div>\n          <RouterLink class=\"block text-right text-blue-600\" to=\"/user/login\">\n            {{\n              `←${t('user.forget-password.login')}`\n            }}\n          </RouterLink>\n        </div>\n      </div>\n      <!-- This div is only for placeholder  -->\n      <div class=\"h-20 w-full\" />\n      <div>© VoileLabs 2019-2022</div>\n    </div>\n    <!-- Desktop view -->\n    <div\n      v-else\n      class=\"flex mr-50 p-5 w-80 h-full flex-wrap content-between text-black bg-white bg-opacity-50 filter drop-shadow-md backdrop-filter backdrop-blur-sm\"\n    >\n      <div class=\"w-full\">\n        <Logo :larger=\"20\" />\n        <div class=\"text-lg text-center\">\n          {{ t('user.forget-password.title') }}\n        </div>\n      </div>\n      <div class=\"w-full space-y-2\">\n        <div>\n          <div class=\"flex w-full border-b border-black\">\n            <div class=\"i-uil:envelope align-middle text-2xl\" />\n            <input\n              v-model=\"email\"\n              class=\"outline-none w-full bg-transparent placeholder-gray-700 text-gray-700\"\n              :placeholder=\"t('user.forget-password.email.placeholder')\"\n              @keydown.enter=\"sendEmail\"\n            >\n          </div>\n          <div class=\"text-red-500 text-sm h-4\">\n            {{ emailStatus }}\n          </div>\n        </div>\n        <div class=\"space-y-1\">\n          <button\n            :disabled=\"sendStatus === 'loading'\"\n            class=\"w-full py-2 border border-transparent rounded-md text-white bg-blue-600 focus:outline-none focus:ring-2 focus:bg-blue-700 disabled:bg-blue-300 disabled:focus:bg-blue-300 disabled:hover:bg-blue-300 disabled:hover:cursor-not-allowed\"\n            @click=\"sendEmail\"\n          >\n            {{\n              sendStatus === 'loading'\n                ? t('user.forget-password.send-status.loading')\n                : t('user.forget-password.send-status.ready')\n            }}\n          </button>\n          <div v-if=\"sendStatus === 'error'\" class=\"text-red-500\">\n            {{ errmsg }}\n          </div>\n          <RouterLink class=\"block text-blue-600 text-right hover:text-blue-800\" to=\"/user/login\">\n            {{\n              `←${t('user.forget-password.login')}`\n            }}\n          </RouterLink>\n        </div>\n      </div>\n      <!-- This div is only for placeholder  -->\n      <div class=\"h-20 w-full\" />\n      <div>© VoileLabs 2019-2022</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { setSiteTitle } from '@/common/libs/setSiteTitle'\nimport { locale } from '@/locales'\nimport { resDataStatus } from '@/common/libs/resDataStatus'\nimport Logo from '@/common/components/Logo.vue'\nimport { screenSizes } from '@/css'\nimport { MessageType, PvMessage } from '@/ui/libs/PvMessage'\n\nconst { t } = useI18n()\nsetSiteTitle(`${t('user.forget-password.title')} - PatchyVideo`)\n\nconst sendStatus = ref<'ready' | 'loading' | 'error'>('ready')\nconst emailFormat\n  = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/\nconst EmailStatus = {\n  fine: t('user.forget-password.email.email-status.fine'),\n  tip: t('user.forget-password.email.email-status.tip'),\n  msg: t('user.forget-password.email.email-status.msg'),\n}\nconst emailStatus = ref<string>(EmailStatus.fine)\n\nconst email = ref<string>('')\nconst errmsg = ref<string>(' ')\n\nasync function sendEmail(): Promise<void> {\n  if (sendStatus.value === 'loading')\n    return\n  sendStatus.value = 'loading'\n\n  /* Form validation  */\n  let valid = true\n  if (!email.value) {\n    valid = false\n    emailStatus.value = EmailStatus.tip\n  }\n  else if (!emailFormat.test(email.value)) {\n    valid = false\n    emailStatus.value = EmailStatus.msg\n  }\n  else {\n    emailStatus.value = EmailStatus.fine\n  }\n  if (!valid) {\n    sendStatus.value = 'ready'\n    return\n  }\n  await fetch('https://patchyvideo.com/be/user/request_resetpass.do', {\n    method: 'POST',\n    headers: new Headers({\n      'Content-Type': 'application/json',\n    }),\n    body: JSON.stringify({\n      email: email.value,\n      lang: locale.value,\n    }),\n    credentials: 'include',\n  })\n    .then(data => data.json())\n    .then((res) => {\n      // console.log(res)\n      if (res.status === resDataStatus.SUCCEED) {\n        sendStatus.value = 'ready'\n        PvMessage({ message: t('user.forget-password.send-status.successful'), type: MessageType.warning })\n      }\n      else if (res.status === resDataStatus.FAILED) {\n        sendStatus.value = 'error'\n        errmsg.value = t('user.forget-password.send-status.failed')\n      }\n      else {\n        sendStatus.value = 'error'\n        errmsg.value = t('user.forget-password.send-status.error')\n      }\n    })\n    .catch((err) => {\n      // console.log(err)\n      sendStatus.value = 'error'\n      errmsg.value = err\n    })\n}\n</script>\n\n<style lang=\"postcss\" scoped>\n@media (max-width: 720px) {\n  .forget-password {\n    background-image: url('./assets/LoginMobile.jpg');\n  }\n}\n@media (min-width: 720px) {\n  .forget-password {\n    background-image: url('./assets/Login.jpg');\n  }\n}\n</style>\n"],"names":["t","useI18n","setSiteTitle","sendStatus","ref","emailFormat","EmailStatus","emailStatus","email","errmsg","sendEmail","valid","locale","data","res","resDataStatus","PvMessage","MessageType","err"],"mappings":"0wDAyHA,KAAA,CAAA,EAAAA,GAAAC,IACAC,EAAA,GAAAF,EAAA,4BAAA,iBAAA,EAEA,MAAAG,EAAAC,EAAA,OAAA,EACAC,EAAA,uIAEAC,EAAA,CAAoB,KAAAN,EAAA,8CAAA,EACoC,IAAAA,EAAA,6CAAA,EACF,IAAAA,EAAA,6CAAA,CACA,EAEtDO,EAAAH,EAAAE,EAAA,IAAA,EAEAE,EAAAJ,EAAA,EAAA,EACAK,EAAAL,EAAA,GAAA,EAEA,eAAAM,GAAA,CACE,GAAAP,EAAA,QAAA,UACE,OACFA,EAAA,MAAA,UAGA,IAAAQ,EAAA,GAYA,GAXAH,EAAA,MAEkCH,EAAA,KAAAG,EAAA,KAAA,EAOhCD,EAAA,MAAAD,EAAA,MAJAK,EAAA,GACAJ,EAAA,MAAAD,EAAA,MALAK,EAAA,GACAJ,EAAA,MAAAD,EAAA,KASF,CAAAK,EAAA,CACER,EAAA,MAAA,QACA,MAAA,CAEF,MAAA,MAAA,uDAAA,CAAoE,OAAA,OAC1D,QAAA,IAAA,QAAA,CACa,eAAA,kBACH,CAAA,EACjB,KAAA,KAAA,UAAA,CACoB,MAAAK,EAAA,MACN,KAAAI,EAAA,KACA,CAAA,EACd,YAAA,SACY,CAAA,EAAA,KAAAC,GAAAA,EAAA,MAAA,EAAA,KAAAC,GAAA,CAKXA,EAAA,SAAAC,EAAA,SACEZ,EAAA,MAAA,QACAa,EAAA,CAAA,QAAAhB,EAAA,6CAAA,EAAA,KAAAiB,EAAA,OAAA,CAAA,GAAkGH,EAAA,SAAAC,EAAA,QAGlGZ,EAAA,MAAA,QACAM,EAAA,MAAAT,EAAA,yCAAA,IAGAG,EAAA,MAAA,QACAM,EAAA,MAAAT,EAAA,wCAAA,EACF,CAAA,EAAA,MAAAkB,GAAA,CAIAf,EAAA,MAAA,QACAM,EAAA,MAAAS,CAAe,CAAA,CAChB"}